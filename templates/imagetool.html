{% extends "base.html" %}

{% block title %}Image Compressor - Optimize Your Images{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Image Compressor</h1>
    <p>Reduce image file sizes while maintaining quality</p>
</div>

<div class="image-tool-container">
    <div class="compression-options">
        <h3>Compression Settings</h3>
        <div class="settings-grid">
            <div class="setting-item">
                <label for="quality-slider">Quality Level:</label>
                <input type="range" id="quality-slider" min="10" max="100" value="80">
                <span id="quality-value">80%</span>
            </div>
            
            <div class="setting-item">
                <label for="format-select">Output Format:</label>
                <select id="format-select">
                    <option value="original">Keep Original</option>
                    <option value="jpeg">JPEG</option>
                    <option value="png">PNG</option>
                    <option value="webp">WebP</option>
                </select>
            </div>
            
            <div class="setting-item">
                <label for="resize-option">Resize Images:</label>
                <select id="resize-option">
                    <option value="none">No Resize</option>
                    <option value="50">50% of original</option>
                    <option value="75">75% of original</option>
                    <option value="custom">Custom Size</option>
                </select>
            </div>
            
            <div class="setting-item" id="custom-size" style="display: none;">
                <label for="custom-width">Max Width:</label>
                <input type="number" id="custom-width" placeholder="1920" min="100" max="4000">
                <label for="custom-height">Max Height:</label>
                <input type="number" id="custom-height" placeholder="1080" min="100" max="4000">
            </div>
        </div>
    </div>

    <div class="upload-section">
        <div class="upload-area">
            <input type="file" id="image-files" multiple accept="image/*" style="display: none;">
            <div class="upload-box" onclick="document.getElementById('image-files').click();">
                <div class="upload-icon">üì∏</div>
                <h3>Upload Images</h3>
                <p>Click to select images or drag and drop</p>
                <small>Supported formats: JPG, PNG, GIF, BMP, TIFF, WebP</small>
            </div>
        </div>
        
        <div id="image-preview" class="image-preview-grid" style="display: none;">
            <!-- Image previews will be dynamically added here -->
        </div>
        
        <div class="action-buttons" id="action-buttons" style="display: none;">
            <button class="btn btn-success" id="compress-all">Compress All Images</button>
            <button class="btn btn-secondary" id="clear-images">Clear All</button>
        </div>
    </div>

    <div id="compression-results" class="results-section" style="display: none;">
        <h3>Compression Results</h3>
        <div class="results-summary">
            <div class="summary-item">
                <span class="label">Total Files:</span>
                <span id="total-files">0</span>
            </div>
            <div class="summary-item">
                <span class="label">Original Size:</span>
                <span id="original-size">0 MB</span>
            </div>
            <div class="summary-item">
                <span class="label">Compressed Size:</span>
                <span id="compressed-size">0 MB</span>
            </div>
            <div class="summary-item">
                <span class="label">Space Saved:</span>
                <span id="space-saved">0%</span>
            </div>
        </div>
        
        <div id="download-section" class="download-section">
            <button class="btn btn-success btn-large" id="download-all">Download All Compressed Images</button>
            <button class="btn btn-primary" onclick="resetImageTool()">Compress More Images</button>
        </div>
    </div>
</div>

<div class="info-section">
    <h3>Image Compression Tips</h3>
    <div class="tips-grid">
        <div class="tip-card">
            <h4>üéØ Quality Settings</h4>
            <p><strong>80-90%:</strong> High quality, small compression<br>
               <strong>60-80%:</strong> Good quality, moderate compression<br>
               <strong>40-60%:</strong> Lower quality, high compression</p>
        </div>
        
        <div class="tip-card">
            <h4>üìê Format Guide</h4>
            <p><strong>JPEG:</strong> Best for photos<br>
               <strong>PNG:</strong> Best for graphics with transparency<br>
               <strong>WebP:</strong> Modern format, excellent compression</p>
        </div>
        
        <div class="tip-card">
            <h4>üîß Best Practices</h4>
            <p>‚Ä¢ Use JPEG for photos, PNG for graphics<br>
               ‚Ä¢ WebP offers the best compression<br>
               ‚Ä¢ Resize large images for web use<br>
               ‚Ä¢ Test different quality settings</p>
        </div>
    </div>
</div>

<script>
// Image compression functionality will be added here
document.getElementById('quality-slider').addEventListener('input', function() {
    document.getElementById('quality-value').textContent = this.value + '%';
});

document.getElementById('resize-option').addEventListener('change', function() {
    const customSize = document.getElementById('custom-size');
    if (this.value === 'custom') {
        customSize.style.display = 'block';
    } else {
        customSize.style.display = 'none';
    }
});

function resetImageTool() {
    document.getElementById('image-preview').style.display = 'none';
    document.getElementById('action-buttons').style.display = 'none';
    document.getElementById('compression-results').style.display = 'none';
    document.getElementById('image-files').value = '';
    document.getElementById('image-preview').innerHTML = '';
}

// File upload handling
document.getElementById('image-files').addEventListener('change', function(e) {
    const files = e.target.files;
    if (files.length > 0) {
        displayImagePreviews(files);
        document.getElementById('action-buttons').style.display = 'block';
    }
});

function displayImagePreviews(files) {
    const preview = document.getElementById('image-preview');
    preview.innerHTML = '';
    preview.style.display = 'grid';
    
    Array.from(files).forEach((file, index) => {
        if (file.type.startsWith('image/')) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const imageCard = document.createElement('div');
                imageCard.className = 'image-card';
                imageCard.innerHTML = `
                    <img src="${e.target.result}" alt="Preview ${index + 1}">
                    <div class="image-info">
                        <p class="filename">${file.name}</p>
                        <p class="filesize">${(file.size / 1024 / 1024).toFixed(2)} MB</p>
                    </div>
                `;
                preview.appendChild(imageCard);
            };
            reader.readAsDataURL(file);
        }
    });
}

// Placeholder for compression functionality
document.getElementById('compress-all').addEventListener('click', function() {
    // This would connect to the backend compression API
    alert('Image compression functionality will be implemented in the backend!');
});
</script>
{% endblock %}
